# Notation

## 音符

### 音符的表示

音符使用`[>v]*[nb\#]?[0-7](,+|'+)?`正则表达式进行匹配，一个音符分为四部分：

1. 演奏法：
   1. 普通演奏法：无前缀
   2. 重音：`>`
   3. 顿音：`v`
2. 升（`#`）降(`b`)还原(`n`)号
3. 唱名(`0-7`，其中`0`为休止符)
4. 音符的附加音高：高八度为`'`，低八度为`,`，高八度的高八度为`''`，低八度的低八度为`,,`，以此类推。

合法的音符：

- `#1''`
- `vn2,,`
- `>v3`：既有顿音又有重音的音符。

非法的音符：

- `bb1,,`：简谱记法里无需支持重升、重降号
- `1'',,`：音符不可既有升号又有降号

### 时值
时值有两种表示方式：显式时值和隐式时值。

#### 显式时值

在音符后加入：

  - 延音线：`-`
  - 下划线：`/`
  - 浮点：`.`

来表示时值，如表示附点八分（十六分）音符，下划线需在浮点之前。什么都不加的音符默认为四分音符，内核最短支持到十六分音符。

#### 隐式时值（暂未支持）

将音符不带空格地写在一起，例如`1'563`或`1,6,`，这种情况下，所有音符的时值之和为四分音符，内核会自动进行时值的推导。在上面的例子里，`1'563`的时值为十六分音符，`1,6,`的时值均为八分音符。

若想要隐式表示前8后16，或前16后8，在其中加入占位符（`_`），例如`1'_56`，这种情况下，`1'`的时值为八分音符，`56`的时值为十六分音符。

需要注意，目前隐式时值仅支持有2个或4个音符（包括占位符）的自动推导，且不可使用浮点其他情况下，并未支持，内核也不会报错，请自查。

## 和弦

和弦使用小括号（`()`）扩起，中间为不含时值的音符，例如`(1,3,n5,)`，内核会自动将其转换为和弦。和弦的时值在括号外使用下划线（`/`）表示，例如`(1,3,n5,)/`，这种情况下，和弦的时值为八分音符。

## 宏

## 设置